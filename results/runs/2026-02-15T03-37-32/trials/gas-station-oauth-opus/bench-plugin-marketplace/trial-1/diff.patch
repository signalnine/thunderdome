diff --git a/.runtime/agent.lock b/.runtime/agent.lock
new file mode 100644
index 0000000..def862c
--- /dev/null
+++ b/.runtime/agent.lock
@@ -0,0 +1,6 @@
+{
+  "pid": 868,
+  "acquired_at": "2026-02-15T03:37:37.498541444Z",
+  "session_id": "bench/rust",
+  "hostname": "4198dd9b9dd0"
+}
\ No newline at end of file
diff --git a/.thunderdome-metrics.json b/.thunderdome-metrics.json
new file mode 100644
index 0000000..3b8d9f9
--- /dev/null
+++ b/.thunderdome-metrics.json
@@ -0,0 +1,17 @@
+{
+  "input_tokens": 23,
+  "output_tokens": 16562,
+  "cache_read_tokens": 588364,
+  "cache_creation_tokens": 26309,
+  "turns": 37,
+  "tools_used": [
+    "Read",
+    "TodoWrite",
+    "Bash",
+    "Glob",
+    "Write",
+    "Edit"
+  ],
+  "duration_ms": 225492,
+  "total_cost_usd": 0.8883402499999997
+}
\ No newline at end of file
diff --git a/package-lock.json b/package-lock.json
index fb449ee..1a20967 100644
--- a/package-lock.json
+++ b/package-lock.json
@@ -16,11 +16,83 @@
         "@types/semver": "^7.5.0",
         "@typescript-eslint/eslint-plugin": "^7.0.0",
         "@typescript-eslint/parser": "^7.0.0",
+        "@vitest/coverage-v8": "^2.0.0",
         "eslint": "^8.56.0",
         "typescript": "^5.4.0",
         "vitest": "^2.0.0"
       }
     },
+    "node_modules/@ampproject/remapping": {
+      "version": "2.3.0",
+      "resolved": "https://registry.npmjs.org/@ampproject/remapping/-/remapping-2.3.0.tgz",
+      "integrity": "sha512-30iZtAPgz+LTIYoeivqYo853f02jBYSd5uGnGpkFV0M3xOt9aN73erkgYAmZU43x4VfqcnLxW9Kpg3R5LC4YYw==",
+      "dev": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "@jridgewell/gen-mapping": "^0.3.5",
+        "@jridgewell/trace-mapping": "^0.3.24"
+      },
+      "engines": {
+        "node": ">=6.0.0"
+      }
+    },
+    "node_modules/@babel/helper-string-parser": {
+      "version": "7.27.1",
+      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
+      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helper-validator-identifier": {
+      "version": "7.28.5",
+      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
+      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/parser": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.29.0.tgz",
+      "integrity": "sha512-IyDgFV5GeDUVX4YdF/3CPULtVGSXXMLh1xVIgdCgxApktqnQV0r7/8Nqthg+8YLGaAtdyIlo2qIdZrbCv4+7ww==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/types": "^7.29.0"
+      },
+      "bin": {
+        "parser": "bin/babel-parser.js"
+      },
+      "engines": {
+        "node": ">=6.0.0"
+      }
+    },
+    "node_modules/@babel/types": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.29.0.tgz",
+      "integrity": "sha512-LwdZHpScM4Qz8Xw2iKSzS+cfglZzJGvofQICy7W7v4caru4EaAmyUuO6BGrbyQ2mYV11W0U8j5mBhd14dd3B0A==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-string-parser": "^7.27.1",
+        "@babel/helper-validator-identifier": "^7.28.5"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@bcoe/v8-coverage": {
+      "version": "0.2.3",
+      "resolved": "https://registry.npmjs.org/@bcoe/v8-coverage/-/v8-coverage-0.2.3.tgz",
+      "integrity": "sha512-0hYQ8SB4Db5zvZB4axdMHGwEaQjkZzFjQiN9LVYvIFB2nSUHW9tYpxWriPrWDASIxiaXax83REcLxuSdnGPZtw==",
+      "dev": true,
+      "license": "MIT"
+    },
     "node_modules/@esbuild/aix-ppc64": {
       "version": "0.21.5",
       "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
@@ -561,6 +633,84 @@
       "dev": true,
       "license": "BSD-3-Clause"
     },
+    "node_modules/@isaacs/cliui": {
+      "version": "8.0.2",
+      "resolved": "https://registry.npmjs.org/@isaacs/cliui/-/cliui-8.0.2.tgz",
+      "integrity": "sha512-O8jcjabXaleOG9DQ0+ARXWZBTfnP4WNAqzuiJK7ll44AmxGKv/J2M4TPjxjY3znBCfvBXFzucm1twdyFybFqEA==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "string-width": "^5.1.2",
+        "string-width-cjs": "npm:string-width@^4.2.0",
+        "strip-ansi": "^7.0.1",
+        "strip-ansi-cjs": "npm:strip-ansi@^6.0.1",
+        "wrap-ansi": "^8.1.0",
+        "wrap-ansi-cjs": "npm:wrap-ansi@^7.0.0"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/@isaacs/cliui/node_modules/ansi-regex": {
+      "version": "6.2.2",
+      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.2.2.tgz",
+      "integrity": "sha512-Bq3SmSpyFHaWjPk8If9yc6svM8c56dB5BAtW4Qbw5jHTwwXXcTLoRMkpDJp6VL0XzlWaCHTXrkFURMYmD0sLqg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/ansi-regex?sponsor=1"
+      }
+    },
+    "node_modules/@isaacs/cliui/node_modules/strip-ansi": {
+      "version": "7.1.2",
+      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-7.1.2.tgz",
+      "integrity": "sha512-gmBGslpoQJtgnMAvOVqGZpEz9dyoKTCzy2nfz/n8aIFhN/jCE/rCmcxabB6jOOHV+0WNnylOxaxBQPSvcWklhA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ansi-regex": "^6.0.1"
+      },
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/strip-ansi?sponsor=1"
+      }
+    },
+    "node_modules/@istanbuljs/schema": {
+      "version": "0.1.3",
+      "resolved": "https://registry.npmjs.org/@istanbuljs/schema/-/schema-0.1.3.tgz",
+      "integrity": "sha512-ZXRY4jNvVgSVQ8DL3LTcakaAtXwTVUxE81hslsyD2AtoXW/wVob10HkOJ1X/pAlcI7D+2YoZKg5do8G/w6RYgA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/@jridgewell/gen-mapping": {
+      "version": "0.3.13",
+      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
+      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jridgewell/sourcemap-codec": "^1.5.0",
+        "@jridgewell/trace-mapping": "^0.3.24"
+      }
+    },
+    "node_modules/@jridgewell/resolve-uri": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
+      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.0.0"
+      }
+    },
     "node_modules/@jridgewell/sourcemap-codec": {
       "version": "1.5.5",
       "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
@@ -568,6 +718,17 @@
       "dev": true,
       "license": "MIT"
     },
+    "node_modules/@jridgewell/trace-mapping": {
+      "version": "0.3.31",
+      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
+      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jridgewell/resolve-uri": "^3.1.0",
+        "@jridgewell/sourcemap-codec": "^1.4.14"
+      }
+    },
     "node_modules/@nodelib/fs.scandir": {
       "version": "2.1.5",
       "resolved": "https://registry.npmjs.org/@nodelib/fs.scandir/-/fs.scandir-2.1.5.tgz",
@@ -606,6 +767,17 @@
         "node": ">= 8"
       }
     },
+    "node_modules/@pkgjs/parseargs": {
+      "version": "0.11.0",
+      "resolved": "https://registry.npmjs.org/@pkgjs/parseargs/-/parseargs-0.11.0.tgz",
+      "integrity": "sha512-+1VkjdD0QBLPodGrJUeqarH8VAIvQODIbwh9XpP5Syisf7YoQgsJKPNFoqqLQlu+VQ/tVSshMR6loPMn8U+dPg==",
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "engines": {
+        "node": ">=14"
+      }
+    },
     "node_modules/@rollup/rollup-android-arm-eabi": {
       "version": "4.57.1",
       "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.57.1.tgz",
@@ -979,7 +1151,6 @@
       "integrity": "sha512-m0jEgYlYz+mDJZ2+F4v8D1AyQb+QzsNqRuI7xg1VQX/KlKS0qT9r1Mo16yo5F/MtifXFgaofIFsdFMox2SxIbQ==",
       "dev": true,
       "license": "MIT",
-      "peer": true,
       "dependencies": {
         "undici-types": "~7.16.0"
       }
@@ -1031,7 +1202,6 @@
       "integrity": "sha512-4Z+L8I2OqhZV8qA132M4wNL30ypZGYOQVBfMgxDH/K5UX0PNqTu1c6za9ST5r9+tavvHiTWmBnKzpCJ/GlVFtg==",
       "dev": true,
       "license": "BSD-2-Clause",
-      "peer": true,
       "dependencies": {
         "@typescript-eslint/scope-manager": "7.18.0",
         "@typescript-eslint/types": "7.18.0",
@@ -1192,6 +1362,39 @@
       "dev": true,
       "license": "ISC"
     },
+    "node_modules/@vitest/coverage-v8": {
+      "version": "2.1.9",
+      "resolved": "https://registry.npmjs.org/@vitest/coverage-v8/-/coverage-v8-2.1.9.tgz",
+      "integrity": "sha512-Z2cOr0ksM00MpEfyVE8KXIYPEcBFxdbLSs56L8PO0QQMxt/6bDj45uQfxoc96v05KW3clk7vvgP0qfDit9DmfQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@ampproject/remapping": "^2.3.0",
+        "@bcoe/v8-coverage": "^0.2.3",
+        "debug": "^4.3.7",
+        "istanbul-lib-coverage": "^3.2.2",
+        "istanbul-lib-report": "^3.0.1",
+        "istanbul-lib-source-maps": "^5.0.6",
+        "istanbul-reports": "^3.1.7",
+        "magic-string": "^0.30.12",
+        "magicast": "^0.3.5",
+        "std-env": "^3.8.0",
+        "test-exclude": "^7.0.1",
+        "tinyrainbow": "^1.2.0"
+      },
+      "funding": {
+        "url": "https://opencollective.com/vitest"
+      },
+      "peerDependencies": {
+        "@vitest/browser": "2.1.9",
+        "vitest": "2.1.9"
+      },
+      "peerDependenciesMeta": {
+        "@vitest/browser": {
+          "optional": true
+        }
+      }
+    },
     "node_modules/@vitest/expect": {
       "version": "2.1.9",
       "resolved": "https://registry.npmjs.org/@vitest/expect/-/expect-2.1.9.tgz",
@@ -1311,7 +1514,6 @@
       "integrity": "sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg==",
       "dev": true,
       "license": "MIT",
-      "peer": true,
       "bin": {
         "acorn": "bin/acorn"
       },
@@ -1710,6 +1912,20 @@
         "node": ">=6.0.0"
       }
     },
+    "node_modules/eastasianwidth": {
+      "version": "0.2.0",
+      "resolved": "https://registry.npmjs.org/eastasianwidth/-/eastasianwidth-0.2.0.tgz",
+      "integrity": "sha512-I88TYZWc9XiYHRQ4/3c5rjjfgkjhLyW2luGIheGERbNQ6OY7yTybanSpDXZa8y7VUP9YmDcYa+eyq4ca7iLqWA==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/emoji-regex": {
+      "version": "9.2.2",
+      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-9.2.2.tgz",
+      "integrity": "sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==",
+      "dev": true,
+      "license": "MIT"
+    },
     "node_modules/end-of-stream": {
       "version": "1.4.5",
       "resolved": "https://registry.npmjs.org/end-of-stream/-/end-of-stream-1.4.5.tgz",
@@ -1785,7 +2001,6 @@
       "deprecated": "This version is no longer supported. Please see https://eslint.org/version-support for other options.",
       "dev": true,
       "license": "MIT",
-      "peer": true,
       "dependencies": {
         "@eslint-community/eslint-utils": "^4.2.0",
         "@eslint-community/regexpp": "^4.6.1",
@@ -2115,6 +2330,23 @@
       "dev": true,
       "license": "ISC"
     },
+    "node_modules/foreground-child": {
+      "version": "3.3.1",
+      "resolved": "https://registry.npmjs.org/foreground-child/-/foreground-child-3.3.1.tgz",
+      "integrity": "sha512-gIXjKqtFuWEgzFRJA9WCQeSJLZDjgJUOMCMzxtvFq/37KojM1BFGufqsCy0r4qSQmYLsZYMeyRqzIWOMup03sw==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "cross-spawn": "^7.0.6",
+        "signal-exit": "^4.0.1"
+      },
+      "engines": {
+        "node": ">=14"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
     "node_modules/fs-constants": {
       "version": "1.0.0",
       "resolved": "https://registry.npmjs.org/fs-constants/-/fs-constants-1.0.0.tgz",
@@ -2262,6 +2494,13 @@
         "node": ">=8"
       }
     },
+    "node_modules/html-escaper": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/html-escaper/-/html-escaper-2.0.2.tgz",
+      "integrity": "sha512-H2iMtd0I4Mt5eYiapRdIDjp+XzelXQ0tFE4JS7YFwFevXXMmOp9myNrUvCg0D6ws8iqkRPBfKHgbwig1SmlLfg==",
+      "dev": true,
+      "license": "MIT"
+    },
     "node_modules/ieee754": {
       "version": "1.2.1",
       "resolved": "https://registry.npmjs.org/ieee754/-/ieee754-1.2.1.tgz",
@@ -2353,6 +2592,16 @@
         "node": ">=0.10.0"
       }
     },
+    "node_modules/is-fullwidth-code-point": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz",
+      "integrity": "sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
     "node_modules/is-glob": {
       "version": "4.0.3",
       "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
@@ -2393,6 +2642,76 @@
       "dev": true,
       "license": "ISC"
     },
+    "node_modules/istanbul-lib-coverage": {
+      "version": "3.2.2",
+      "resolved": "https://registry.npmjs.org/istanbul-lib-coverage/-/istanbul-lib-coverage-3.2.2.tgz",
+      "integrity": "sha512-O8dpsF+r0WV/8MNRKfnmrtCWhuKjxrq2w+jpzBL5UZKTi2LeVWnWOmWRxFlesJONmc+wLAGvKQZEOanko0LFTg==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/istanbul-lib-report": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/istanbul-lib-report/-/istanbul-lib-report-3.0.1.tgz",
+      "integrity": "sha512-GCfE1mtsHGOELCU8e/Z7YWzpmybrx/+dSTfLrvY8qRmaY6zXTKWn6WQIjaAFw069icm6GVMNkgu0NzI4iPZUNw==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "istanbul-lib-coverage": "^3.0.0",
+        "make-dir": "^4.0.0",
+        "supports-color": "^7.1.0"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/istanbul-lib-source-maps": {
+      "version": "5.0.6",
+      "resolved": "https://registry.npmjs.org/istanbul-lib-source-maps/-/istanbul-lib-source-maps-5.0.6.tgz",
+      "integrity": "sha512-yg2d+Em4KizZC5niWhQaIomgf5WlL4vOOjZ5xGCmF8SnPE/mDWWXgvRExdcpCgh9lLRRa1/fSYp2ymmbJ1pI+A==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "@jridgewell/trace-mapping": "^0.3.23",
+        "debug": "^4.1.1",
+        "istanbul-lib-coverage": "^3.0.0"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/istanbul-reports": {
+      "version": "3.2.0",
+      "resolved": "https://registry.npmjs.org/istanbul-reports/-/istanbul-reports-3.2.0.tgz",
+      "integrity": "sha512-HGYWWS/ehqTV3xN10i23tkPkpH46MLCIMFNCaaKNavAXTF1RkqxawEPtnjnGZ6XKSInBKkiOA5BKS+aZiY3AvA==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "html-escaper": "^2.0.0",
+        "istanbul-lib-report": "^3.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/jackspeak": {
+      "version": "3.4.3",
+      "resolved": "https://registry.npmjs.org/jackspeak/-/jackspeak-3.4.3.tgz",
+      "integrity": "sha512-OGlZQpz2yfahA/Rd1Y8Cd9SIEsqvXkLVoSw/cgwhnhFMDbsQFeZYoJJ7bIZBS9BcamUW96asq/npPWugM+RQBw==",
+      "dev": true,
+      "license": "BlueOak-1.0.0",
+      "dependencies": {
+        "@isaacs/cliui": "^8.0.2"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      },
+      "optionalDependencies": {
+        "@pkgjs/parseargs": "^0.11.0"
+      }
+    },
     "node_modules/js-yaml": {
       "version": "4.1.1",
       "resolved": "https://registry.npmjs.org/js-yaml/-/js-yaml-4.1.1.tgz",
@@ -2481,6 +2800,13 @@
       "dev": true,
       "license": "MIT"
     },
+    "node_modules/lru-cache": {
+      "version": "10.4.3",
+      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-10.4.3.tgz",
+      "integrity": "sha512-JNAzZcXrCt42VGLuYz0zfAzDfAvJWW6AfYlDBQyDV5DClI2m5sAmK+OIO7s59XfsRsWHp02jAJrRadPRGTt6SQ==",
+      "dev": true,
+      "license": "ISC"
+    },
     "node_modules/magic-string": {
       "version": "0.30.21",
       "resolved": "https://registry.npmjs.org/magic-string/-/magic-string-0.30.21.tgz",
@@ -2491,6 +2817,34 @@
         "@jridgewell/sourcemap-codec": "^1.5.5"
       }
     },
+    "node_modules/magicast": {
+      "version": "0.3.5",
+      "resolved": "https://registry.npmjs.org/magicast/-/magicast-0.3.5.tgz",
+      "integrity": "sha512-L0WhttDl+2BOsybvEOLK7fW3UA0OQ0IQ2d6Zl2x/a6vVRs3bAY0ECOSHHeL5jD+SbOpOCUEi0y1DgHEn9Qn1AQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/parser": "^7.25.4",
+        "@babel/types": "^7.25.4",
+        "source-map-js": "^1.2.0"
+      }
+    },
+    "node_modules/make-dir": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/make-dir/-/make-dir-4.0.0.tgz",
+      "integrity": "sha512-hXdUTZYIVOt1Ex//jAQi+wTZZpUpwBj/0QsOzqegb3rGMMeJiSEu5xLHnYfBrRV4RH2+OCSOO95Is/7x1WJ4bw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "semver": "^7.5.3"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
     "node_modules/merge2": {
       "version": "1.4.1",
       "resolved": "https://registry.npmjs.org/merge2/-/merge2-1.4.1.tgz",
@@ -2552,6 +2906,16 @@
         "url": "https://github.com/sponsors/ljharb"
       }
     },
+    "node_modules/minipass": {
+      "version": "7.1.2",
+      "resolved": "https://registry.npmjs.org/minipass/-/minipass-7.1.2.tgz",
+      "integrity": "sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==",
+      "dev": true,
+      "license": "ISC",
+      "engines": {
+        "node": ">=16 || 14 >=14.17"
+      }
+    },
     "node_modules/mkdirp-classic": {
       "version": "0.5.3",
       "resolved": "https://registry.npmjs.org/mkdirp-classic/-/mkdirp-classic-0.5.3.tgz",
@@ -2668,6 +3032,13 @@
         "url": "https://github.com/sponsors/sindresorhus"
       }
     },
+    "node_modules/package-json-from-dist": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/package-json-from-dist/-/package-json-from-dist-1.0.1.tgz",
+      "integrity": "sha512-UEZIS3/by4OC8vL3P2dTXRETpebLI2NiI5vIrjaD/5UtrkFX/tNbwjTSRAGC/+7CAo2pIcBaRgWmcBBHcsaCIw==",
+      "dev": true,
+      "license": "BlueOak-1.0.0"
+    },
     "node_modules/parent-module": {
       "version": "1.0.1",
       "resolved": "https://registry.npmjs.org/parent-module/-/parent-module-1.0.1.tgz",
@@ -2711,6 +3082,23 @@
         "node": ">=8"
       }
     },
+    "node_modules/path-scurry": {
+      "version": "1.11.1",
+      "resolved": "https://registry.npmjs.org/path-scurry/-/path-scurry-1.11.1.tgz",
+      "integrity": "sha512-Xa4Nw17FS9ApQFJ9umLiJS4orGjm7ZzwUrwamcGQuHSzDyth9boKDaycYdDcZDuqYATXw4HFXgaqWTctW/v1HA==",
+      "dev": true,
+      "license": "BlueOak-1.0.0",
+      "dependencies": {
+        "lru-cache": "^10.2.0",
+        "minipass": "^5.0.0 || ^6.0.2 || ^7.0.0"
+      },
+      "engines": {
+        "node": ">=16 || 14 >=14.18"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
     "node_modules/path-type": {
       "version": "4.0.0",
       "resolved": "https://registry.npmjs.org/path-type/-/path-type-4.0.0.tgz",
@@ -3071,6 +3459,19 @@
       "dev": true,
       "license": "ISC"
     },
+    "node_modules/signal-exit": {
+      "version": "4.1.0",
+      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-4.1.0.tgz",
+      "integrity": "sha512-bzyZ1e88w9O1iNJbKnOlvYTrWPDl46O1bG0D3XInv+9tkPrxrN8jUUTiFlDkkmKWgn1M6CfIA13SuGqOa9Korw==",
+      "dev": true,
+      "license": "ISC",
+      "engines": {
+        "node": ">=14"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
     "node_modules/simple-concat": {
       "version": "1.0.1",
       "resolved": "https://registry.npmjs.org/simple-concat/-/simple-concat-1.0.1.tgz",
@@ -3159,6 +3560,76 @@
         "safe-buffer": "~5.2.0"
       }
     },
+    "node_modules/string-width": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/string-width/-/string-width-5.1.2.tgz",
+      "integrity": "sha512-HnLOCR3vjcY8beoNLtcjZ5/nxn2afmME6lhrDrebokqMap+XbeW8n9TXpPDOqdGK5qcI3oT0GKTW6wC7EMiVqA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "eastasianwidth": "^0.2.0",
+        "emoji-regex": "^9.2.2",
+        "strip-ansi": "^7.0.1"
+      },
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/string-width-cjs": {
+      "name": "string-width",
+      "version": "4.2.3",
+      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
+      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "emoji-regex": "^8.0.0",
+        "is-fullwidth-code-point": "^3.0.0",
+        "strip-ansi": "^6.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/string-width-cjs/node_modules/emoji-regex": {
+      "version": "8.0.0",
+      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
+      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/string-width/node_modules/ansi-regex": {
+      "version": "6.2.2",
+      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.2.2.tgz",
+      "integrity": "sha512-Bq3SmSpyFHaWjPk8If9yc6svM8c56dB5BAtW4Qbw5jHTwwXXcTLoRMkpDJp6VL0XzlWaCHTXrkFURMYmD0sLqg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/ansi-regex?sponsor=1"
+      }
+    },
+    "node_modules/string-width/node_modules/strip-ansi": {
+      "version": "7.1.2",
+      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-7.1.2.tgz",
+      "integrity": "sha512-gmBGslpoQJtgnMAvOVqGZpEz9dyoKTCzy2nfz/n8aIFhN/jCE/rCmcxabB6jOOHV+0WNnylOxaxBQPSvcWklhA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ansi-regex": "^6.0.1"
+      },
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/strip-ansi?sponsor=1"
+      }
+    },
     "node_modules/strip-ansi": {
       "version": "6.0.1",
       "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
@@ -3172,6 +3643,20 @@
         "node": ">=8"
       }
     },
+    "node_modules/strip-ansi-cjs": {
+      "name": "strip-ansi",
+      "version": "6.0.1",
+      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
+      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ansi-regex": "^5.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
     "node_modules/strip-json-comments": {
       "version": "3.1.1",
       "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-3.1.1.tgz",
@@ -3226,6 +3711,43 @@
         "node": ">=6"
       }
     },
+    "node_modules/test-exclude": {
+      "version": "7.0.1",
+      "resolved": "https://registry.npmjs.org/test-exclude/-/test-exclude-7.0.1.tgz",
+      "integrity": "sha512-pFYqmTw68LXVjeWJMST4+borgQP2AyMNbg1BpZh9LbyhUeNkeaPF9gzfPGUAnSMV3qPYdWUwDIjjCLiSDOl7vg==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "@istanbuljs/schema": "^0.1.2",
+        "glob": "^10.4.1",
+        "minimatch": "^9.0.4"
+      },
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/test-exclude/node_modules/glob": {
+      "version": "10.5.0",
+      "resolved": "https://registry.npmjs.org/glob/-/glob-10.5.0.tgz",
+      "integrity": "sha512-DfXN8DfhJ7NH3Oe7cFmu3NCu1wKbkReJ8TorzSAFbSKrlNaQSKfIzqYqVY8zlbs2NLBbWpRiU52GX2PbaBVNkg==",
+      "deprecated": "Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "foreground-child": "^3.1.0",
+        "jackspeak": "^3.1.2",
+        "minimatch": "^9.0.4",
+        "minipass": "^7.1.2",
+        "package-json-from-dist": "^1.0.0",
+        "path-scurry": "^1.11.1"
+      },
+      "bin": {
+        "glob": "dist/esm/bin.mjs"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
     "node_modules/text-table": {
       "version": "0.2.0",
       "resolved": "https://registry.npmjs.org/text-table/-/text-table-0.2.0.tgz",
@@ -3347,7 +3869,6 @@
       "integrity": "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==",
       "dev": true,
       "license": "Apache-2.0",
-      "peer": true,
       "bin": {
         "tsc": "bin/tsc",
         "tsserver": "bin/tsserver"
@@ -3571,6 +4092,107 @@
         "node": ">=0.10.0"
       }
     },
+    "node_modules/wrap-ansi": {
+      "version": "8.1.0",
+      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-8.1.0.tgz",
+      "integrity": "sha512-si7QWI6zUMq56bESFvagtmzMdGOtoxfR+Sez11Mobfc7tm+VkUckk9bW2UeffTGVUbOksxmSw0AA2gs8g71NCQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ansi-styles": "^6.1.0",
+        "string-width": "^5.0.1",
+        "strip-ansi": "^7.0.1"
+      },
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
+      }
+    },
+    "node_modules/wrap-ansi-cjs": {
+      "name": "wrap-ansi",
+      "version": "7.0.0",
+      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
+      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ansi-styles": "^4.0.0",
+        "string-width": "^4.1.0",
+        "strip-ansi": "^6.0.0"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
+      }
+    },
+    "node_modules/wrap-ansi-cjs/node_modules/emoji-regex": {
+      "version": "8.0.0",
+      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
+      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/wrap-ansi-cjs/node_modules/string-width": {
+      "version": "4.2.3",
+      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
+      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "emoji-regex": "^8.0.0",
+        "is-fullwidth-code-point": "^3.0.0",
+        "strip-ansi": "^6.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/wrap-ansi/node_modules/ansi-regex": {
+      "version": "6.2.2",
+      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.2.2.tgz",
+      "integrity": "sha512-Bq3SmSpyFHaWjPk8If9yc6svM8c56dB5BAtW4Qbw5jHTwwXXcTLoRMkpDJp6VL0XzlWaCHTXrkFURMYmD0sLqg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/ansi-regex?sponsor=1"
+      }
+    },
+    "node_modules/wrap-ansi/node_modules/ansi-styles": {
+      "version": "6.2.3",
+      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-6.2.3.tgz",
+      "integrity": "sha512-4Dj6M28JB+oAH8kFkTLUo+a2jwOFkuqb3yucU0CANcRRUbxS0cP0nZYCGjcc3BNXwRIsUVmDGgzawme7zvJHvg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
+      }
+    },
+    "node_modules/wrap-ansi/node_modules/strip-ansi": {
+      "version": "7.1.2",
+      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-7.1.2.tgz",
+      "integrity": "sha512-gmBGslpoQJtgnMAvOVqGZpEz9dyoKTCzy2nfz/n8aIFhN/jCE/rCmcxabB6jOOHV+0WNnylOxaxBQPSvcWklhA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ansi-regex": "^6.0.1"
+      },
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/strip-ansi?sponsor=1"
+      }
+    },
     "node_modules/wrappy": {
       "version": "1.0.2",
       "resolved": "https://registry.npmjs.org/wrappy/-/wrappy-1.0.2.tgz",
diff --git a/src/deps/deps.test.ts b/src/deps/deps.test.ts
new file mode 100644
index 0000000..9233116
--- /dev/null
+++ b/src/deps/deps.test.ts
@@ -0,0 +1,127 @@
+import { describe, it, expect, beforeEach } from 'vitest';
+import { createDepsService } from './index.js';
+import { createRegistry } from '../registry/index.js';
+import type { DepsService, RegistryService, PluginManifest } from '../types.js';
+
+function makeManifest(
+  name: string,
+  deps: Record<string, string> = {}
+): PluginManifest {
+  return {
+    name,
+    version: '1.0.0',
+    description: '',
+    author: 'test',
+    dependencies: deps,
+    entryPoint: '',
+    permissions: [],
+  };
+}
+
+describe('DepsService', () => {
+  let depsService: DepsService;
+  let registry: RegistryService;
+
+  beforeEach(() => {
+    depsService = createDepsService();
+    registry = createRegistry();
+  });
+
+  describe('buildTree', () => {
+    it('should build a simple tree', () => {
+      registry.register(makeManifest('a', { b: '^1.0.0' }));
+      registry.register(makeManifest('b'));
+      const tree = depsService.buildTree('a', registry);
+      expect(tree.name).toBe('a');
+      expect(tree.dependencies).toHaveLength(1);
+      expect(tree.dependencies[0].name).toBe('b');
+    });
+
+    it('should handle missing dependencies', () => {
+      registry.register(makeManifest('a', { missing: '^1.0.0' }));
+      const tree = depsService.buildTree('a', registry);
+      expect(tree.dependencies[0].name).toBe('missing');
+      expect(tree.dependencies[0].version).toBe('unknown');
+    });
+
+    it('should handle deep trees', () => {
+      registry.register(makeManifest('a', { b: '^1.0.0' }));
+      registry.register(makeManifest('b', { c: '^1.0.0' }));
+      registry.register(makeManifest('c'));
+      const tree = depsService.buildTree('a', registry);
+      expect(tree.dependencies[0].dependencies[0].name).toBe('c');
+    });
+  });
+
+  describe('detectCycles', () => {
+    it('should detect circular dependencies', () => {
+      registry.register(makeManifest('a', { b: '^1.0.0' }));
+      registry.register(makeManifest('b', { a: '^1.0.0' }));
+      const cycles = depsService.detectCycles('a', registry);
+      expect(cycles).not.toBeNull();
+      expect(cycles!.length).toBeGreaterThan(0);
+    });
+
+    it('should return null for no cycles', () => {
+      registry.register(makeManifest('a', { b: '^1.0.0' }));
+      registry.register(makeManifest('b'));
+      expect(depsService.detectCycles('a', registry)).toBeNull();
+    });
+
+    it('should detect indirect cycles', () => {
+      registry.register(makeManifest('a', { b: '^1.0.0' }));
+      registry.register(makeManifest('b', { c: '^1.0.0' }));
+      registry.register(makeManifest('c', { a: '^1.0.0' }));
+      const cycles = depsService.detectCycles('a', registry);
+      expect(cycles).not.toBeNull();
+    });
+  });
+
+  describe('topologicalSort', () => {
+    it('should produce correct order', () => {
+      registry.register(makeManifest('a', { b: '^1.0.0', c: '^1.0.0' }));
+      registry.register(makeManifest('b', { c: '^1.0.0' }));
+      registry.register(makeManifest('c'));
+      const order = depsService.topologicalSort('a', registry);
+      expect(order.indexOf('c')).toBeLessThan(order.indexOf('b'));
+      expect(order.indexOf('b')).toBeLessThan(order.indexOf('a'));
+    });
+
+    it('should include the root', () => {
+      registry.register(makeManifest('a'));
+      const order = depsService.topologicalSort('a', registry);
+      expect(order).toContain('a');
+    });
+  });
+
+  describe('flattenDependencies', () => {
+    it('should return all transitive deps without root', () => {
+      registry.register(makeManifest('a', { b: '^1.0.0' }));
+      registry.register(makeManifest('b', { c: '^1.0.0' }));
+      registry.register(makeManifest('c'));
+      const flat = depsService.flattenDependencies('a', registry);
+      expect(flat).toContain('b');
+      expect(flat).toContain('c');
+      expect(flat).not.toContain('a');
+    });
+
+    it('should return empty for no deps', () => {
+      registry.register(makeManifest('a'));
+      expect(depsService.flattenDependencies('a', registry)).toEqual([]);
+    });
+  });
+
+  describe('hasCircularDependency', () => {
+    it('should return true for cycles', () => {
+      registry.register(makeManifest('a', { b: '^1.0.0' }));
+      registry.register(makeManifest('b', { a: '^1.0.0' }));
+      expect(depsService.hasCircularDependency('a', registry)).toBe(true);
+    });
+
+    it('should return false for no cycles', () => {
+      registry.register(makeManifest('a', { b: '^1.0.0' }));
+      registry.register(makeManifest('b'));
+      expect(depsService.hasCircularDependency('a', registry)).toBe(false);
+    });
+  });
+});
diff --git a/src/deps/index.ts b/src/deps/index.ts
new file mode 100644
index 0000000..4ff861e
--- /dev/null
+++ b/src/deps/index.ts
@@ -0,0 +1,126 @@
+import type { DependencyNode, DepsService, RegistryService } from '../types.js';
+
+export function createDepsService(): DepsService {
+  function buildTreeInternal(
+    name: string,
+    registry: RegistryService,
+    visited: Set<string>
+  ): DependencyNode {
+    const manifest = registry.get(name);
+    if (!manifest) {
+      return { name, version: 'unknown', dependencies: [] };
+    }
+
+    const node: DependencyNode = {
+      name: manifest.name,
+      version: manifest.version,
+      dependencies: [],
+    };
+
+    if (visited.has(name)) {
+      return node;
+    }
+
+    visited.add(name);
+
+    for (const depName of Object.keys(manifest.dependencies)) {
+      node.dependencies.push(buildTreeInternal(depName, registry, new Set(visited)));
+    }
+
+    return node;
+  }
+
+  function detectCyclesInternal(
+    name: string,
+    registry: RegistryService,
+    path: string[],
+    allCycles: string[][]
+  ): void {
+    const cycleStart = path.indexOf(name);
+    if (cycleStart !== -1) {
+      const cycle = path.slice(cycleStart).concat(name);
+      allCycles.push(cycle);
+      return;
+    }
+
+    const manifest = registry.get(name);
+    if (!manifest) return;
+
+    path.push(name);
+    for (const depName of Object.keys(manifest.dependencies)) {
+      detectCyclesInternal(depName, registry, [...path], allCycles);
+    }
+  }
+
+  function collectDeps(
+    name: string,
+    registry: RegistryService,
+    visited: Set<string>,
+    order: string[]
+  ): boolean {
+    if (order.includes(name)) return true;
+    if (visited.has(name)) return false; // cycle
+
+    visited.add(name);
+
+    const manifest = registry.get(name);
+    if (manifest) {
+      for (const depName of Object.keys(manifest.dependencies)) {
+        if (!collectDeps(depName, registry, visited, order)) {
+          return false;
+        }
+      }
+    }
+
+    order.push(name);
+    return true;
+  }
+
+  return {
+    buildTree(name: string, registry: RegistryService): DependencyNode {
+      return buildTreeInternal(name, registry, new Set());
+    },
+
+    detectCycles(name: string, registry: RegistryService): string[][] | null {
+      const cycles: string[][] = [];
+      detectCyclesInternal(name, registry, [], cycles);
+      return cycles.length > 0 ? cycles : null;
+    },
+
+    topologicalSort(name: string, registry: RegistryService): string[] {
+      const visited = new Set<string>();
+      const order: string[] = [];
+      collectDeps(name, registry, visited, order);
+      return order;
+    },
+
+    flattenDependencies(name: string, registry: RegistryService): string[] {
+      const visited = new Set<string>();
+      const deps: string[] = [];
+
+      function collect(n: string): void {
+        if (visited.has(n)) return;
+        visited.add(n);
+
+        const manifest = registry.get(n);
+        if (!manifest) return;
+
+        for (const depName of Object.keys(manifest.dependencies)) {
+          collect(depName);
+        }
+
+        if (n !== name) {
+          deps.push(n);
+        }
+      }
+
+      collect(name);
+      return deps;
+    },
+
+    hasCircularDependency(name: string, registry: RegistryService): boolean {
+      const cycles = this.detectCycles(name, registry);
+      return cycles !== null;
+    },
+  };
+}
diff --git a/src/index.test.ts b/src/index.test.ts
new file mode 100644
index 0000000..46dcf0e
--- /dev/null
+++ b/src/index.test.ts
@@ -0,0 +1,122 @@
+import { describe, it, expect, beforeEach } from 'vitest';
+import { createMarketplace } from './index.js';
+import type { Marketplace } from './index.js';
+import type { PluginManifest } from './types.js';
+
+function makeManifest(overrides: Partial<PluginManifest> = {}): PluginManifest {
+  return {
+    name: 'test-plugin',
+    version: '1.0.0',
+    description: 'A test plugin',
+    author: 'tester',
+    dependencies: {},
+    entryPoint: '1 + 1',
+    permissions: [],
+    ...overrides,
+  };
+}
+
+describe('Marketplace Integration', () => {
+  let marketplace: Marketplace;
+
+  beforeEach(() => {
+    marketplace = createMarketplace();
+  });
+
+  it('should create a marketplace with all services', () => {
+    expect(marketplace.registry).toBeDefined();
+    expect(marketplace.resolver).toBeDefined();
+    expect(marketplace.runner).toBeDefined();
+    expect(marketplace.reviews).toBeDefined();
+    expect(marketplace.deps).toBeDefined();
+    expect(marketplace.installPlugin).toBeDefined();
+  });
+
+  describe('installPlugin', () => {
+    it('should install a simple plugin', async () => {
+      const result = await marketplace.installPlugin(makeManifest());
+      expect(result.resolvedDependencies).toEqual([]);
+      expect(result.executionResult.success).toBe(true);
+      expect(result.executionResult.output).toBe(2);
+    });
+
+    it('should register the plugin in the registry', async () => {
+      await marketplace.installPlugin(makeManifest());
+      const plugin = marketplace.registry.get('test-plugin');
+      expect(plugin).not.toBeNull();
+      expect(plugin!.name).toBe('test-plugin');
+    });
+
+    it('should resolve dependencies', async () => {
+      // First register the dependency
+      marketplace.registry.register(
+        makeManifest({ name: 'dep-lib', version: '1.2.0' })
+      );
+
+      const result = await marketplace.installPlugin(
+        makeManifest({
+          name: 'my-plugin',
+          dependencies: { 'dep-lib': '^1.0.0' },
+        })
+      );
+      expect(result.resolvedDependencies).toHaveLength(1);
+      expect(result.resolvedDependencies[0].name).toBe('dep-lib');
+      expect(result.resolvedDependencies[0].version).toBe('1.2.0');
+    });
+
+    it('should reject plugin without name', async () => {
+      await expect(
+        marketplace.installPlugin(makeManifest({ name: '' }))
+      ).rejects.toThrow('name');
+    });
+
+    it('should reject plugin without version', async () => {
+      await expect(
+        marketplace.installPlugin(makeManifest({ version: '' }))
+      ).rejects.toThrow('version');
+    });
+
+    it('should reject plugin without entryPoint', async () => {
+      await expect(
+        marketplace.installPlugin(makeManifest({ entryPoint: '' }))
+      ).rejects.toThrow('entryPoint');
+    });
+
+    it('should reject circular dependencies', async () => {
+      // Set up a cycle: a depends on b, b depends on a
+      marketplace.registry.register(
+        makeManifest({ name: 'dep-a', dependencies: { 'dep-b': '^1.0.0' } })
+      );
+      marketplace.registry.register(
+        makeManifest({ name: 'dep-b', dependencies: { 'dep-a': '^1.0.0' } })
+      );
+
+      // Now try to install something that depends on dep-a
+      await expect(
+        marketplace.installPlugin(
+          makeManifest({
+            name: 'dep-a',
+            version: '2.0.0',
+            dependencies: { 'dep-b': '^1.0.0' },
+          })
+        )
+      ).rejects.toThrow('Circular dependency');
+    });
+
+    it('should execute the entry point code', async () => {
+      const result = await marketplace.installPlugin(
+        makeManifest({ entryPoint: '42' })
+      );
+      expect(result.executionResult.success).toBe(true);
+      expect(result.executionResult.output).toBe(42);
+    });
+
+    it('should handle entry point errors gracefully', async () => {
+      const result = await marketplace.installPlugin(
+        makeManifest({ entryPoint: 'throw new Error("plugin error")' })
+      );
+      expect(result.executionResult.success).toBe(false);
+      expect(result.executionResult.error).toBe('plugin error');
+    });
+  });
+});
diff --git a/src/index.ts b/src/index.ts
new file mode 100644
index 0000000..3ee5faf
--- /dev/null
+++ b/src/index.ts
@@ -0,0 +1,101 @@
+import type {
+  PluginManifest,
+  RegistryService,
+  ResolverService,
+  RunnerService,
+  ReviewService,
+  DepsService,
+  ResolvedVersion,
+  SandboxResult,
+  VersionConstraint,
+} from './types.js';
+import { createRegistry } from './registry/index.js';
+import { createResolver } from './resolver/index.js';
+import { createRunner } from './runner/index.js';
+import { createReviewService } from './reviews/index.js';
+import { createDepsService } from './deps/index.js';
+
+export interface InstallResult {
+  resolvedDependencies: ResolvedVersion[];
+  executionResult: SandboxResult;
+}
+
+export interface Marketplace {
+  registry: RegistryService;
+  resolver: ResolverService;
+  runner: RunnerService;
+  reviews: ReviewService;
+  deps: DepsService;
+  installPlugin(manifest: PluginManifest): Promise<InstallResult>;
+}
+
+export function createMarketplace(): Marketplace {
+  const registry = createRegistry();
+  const resolver = createResolver();
+  const runner = createRunner();
+  const reviews = createReviewService();
+  const deps = createDepsService();
+
+  async function installPlugin(manifest: PluginManifest): Promise<InstallResult> {
+    // Validate required fields
+    if (!manifest.name) {
+      throw new Error('Plugin manifest must have a name');
+    }
+    if (!manifest.version) {
+      throw new Error('Plugin manifest must have a version');
+    }
+    if (!manifest.entryPoint) {
+      throw new Error('Plugin manifest must have an entryPoint');
+    }
+
+    // Register the plugin
+    registry.register(manifest);
+
+    // Resolve dependency versions
+    const constraints: VersionConstraint[] = Object.entries(
+      manifest.dependencies || {}
+    ).map(([name, range]) => ({ name, range }));
+
+    let resolvedDependencies: ResolvedVersion[] = [];
+    if (constraints.length > 0) {
+      // Build available versions map from registry
+      const available: Record<string, string[]> = {};
+      for (const constraint of constraints) {
+        available[constraint.name] = registry.listVersions(constraint.name);
+      }
+      resolvedDependencies = resolver.resolve(constraints, available);
+    }
+
+    // Check for circular dependencies
+    if (deps.hasCircularDependency(manifest.name, registry)) {
+      // Remove the plugin we just registered since it creates a cycle
+      registry.remove(manifest.name, manifest.version);
+      throw new Error(
+        `Circular dependency detected for plugin "${manifest.name}"`
+      );
+    }
+
+    // Execute the plugin's entry point in the sandbox
+    const executionResult = await runner.execute(manifest.entryPoint);
+
+    return {
+      resolvedDependencies,
+      executionResult,
+    };
+  }
+
+  return {
+    registry,
+    resolver,
+    runner,
+    reviews,
+    deps,
+    installPlugin,
+  };
+}
+
+export { createRegistry } from './registry/index.js';
+export { createResolver } from './resolver/index.js';
+export { createRunner } from './runner/index.js';
+export { createReviewService } from './reviews/index.js';
+export { createDepsService } from './deps/index.js';
diff --git a/src/registry/index.ts b/src/registry/index.ts
new file mode 100644
index 0000000..5c7a175
--- /dev/null
+++ b/src/registry/index.ts
@@ -0,0 +1,89 @@
+import type { PluginManifest, RegistryService } from '../types.js';
+
+export function createRegistry(): RegistryService {
+  // Map of name -> Map of version -> manifest
+  const plugins = new Map<string, Map<string, PluginManifest>>();
+
+  return {
+    register(manifest: PluginManifest): void {
+      if (!manifest.name || !manifest.version) {
+        throw new Error('Plugin manifest must have a name and version');
+      }
+      let versions = plugins.get(manifest.name);
+      if (!versions) {
+        versions = new Map();
+        plugins.set(manifest.name, versions);
+      }
+      versions.set(manifest.version, { ...manifest });
+    },
+
+    get(name: string): PluginManifest | null {
+      const versions = plugins.get(name);
+      if (!versions || versions.size === 0) return null;
+      // Return the latest registered version (last entry)
+      let latest: PluginManifest | null = null;
+      for (const manifest of versions.values()) {
+        latest = manifest;
+      }
+      return latest ? { ...latest } : null;
+    },
+
+    getVersion(name: string, version: string): PluginManifest | null {
+      const versions = plugins.get(name);
+      if (!versions) return null;
+      const manifest = versions.get(version);
+      return manifest ? { ...manifest } : null;
+    },
+
+    list(): PluginManifest[] {
+      const result: PluginManifest[] = [];
+      for (const versions of plugins.values()) {
+        for (const manifest of versions.values()) {
+          result.push({ ...manifest });
+        }
+      }
+      return result;
+    },
+
+    search(query: string): PluginManifest[] {
+      const q = query.toLowerCase();
+      const result: PluginManifest[] = [];
+      for (const versions of plugins.values()) {
+        for (const manifest of versions.values()) {
+          if (
+            manifest.name.toLowerCase().includes(q) ||
+            manifest.description.toLowerCase().includes(q) ||
+            manifest.author.toLowerCase().includes(q)
+          ) {
+            result.push({ ...manifest });
+          }
+        }
+      }
+      return result;
+    },
+
+    remove(name: string, version: string): boolean {
+      const versions = plugins.get(name);
+      if (!versions) return false;
+      const deleted = versions.delete(version);
+      if (versions.size === 0) {
+        plugins.delete(name);
+      }
+      return deleted;
+    },
+
+    listVersions(name: string): string[] {
+      const versions = plugins.get(name);
+      if (!versions) return [];
+      return Array.from(versions.keys());
+    },
+
+    update(name: string, version: string, updates: Partial<PluginManifest>): void {
+      const versions = plugins.get(name);
+      if (!versions) throw new Error(`Plugin "${name}" not found`);
+      const manifest = versions.get(version);
+      if (!manifest) throw new Error(`Plugin "${name}@${version}" not found`);
+      Object.assign(manifest, updates);
+    },
+  };
+}
diff --git a/src/registry/registry.test.ts b/src/registry/registry.test.ts
new file mode 100644
index 0000000..ac89412
--- /dev/null
+++ b/src/registry/registry.test.ts
@@ -0,0 +1,132 @@
+import { describe, it, expect, beforeEach } from 'vitest';
+import { createRegistry } from './index.js';
+import type { PluginManifest, RegistryService } from '../types.js';
+
+function makeManifest(overrides: Partial<PluginManifest> = {}): PluginManifest {
+  return {
+    name: 'test-plugin',
+    version: '1.0.0',
+    description: 'A test plugin',
+    author: 'tester',
+    dependencies: {},
+    entryPoint: 'console.log("hello")',
+    permissions: [],
+    ...overrides,
+  };
+}
+
+describe('Registry', () => {
+  let registry: RegistryService;
+
+  beforeEach(() => {
+    registry = createRegistry();
+  });
+
+  it('should register and get a plugin', () => {
+    const manifest = makeManifest();
+    registry.register(manifest);
+    const result = registry.get('test-plugin');
+    expect(result).not.toBeNull();
+    expect(result!.name).toBe('test-plugin');
+    expect(result!.version).toBe('1.0.0');
+  });
+
+  it('should return null for unknown plugin', () => {
+    expect(registry.get('unknown')).toBeNull();
+  });
+
+  it('should get a specific version', () => {
+    registry.register(makeManifest({ version: '1.0.0' }));
+    registry.register(makeManifest({ version: '2.0.0' }));
+    const result = registry.getVersion('test-plugin', '1.0.0');
+    expect(result).not.toBeNull();
+    expect(result!.version).toBe('1.0.0');
+  });
+
+  it('should return null for unknown version', () => {
+    registry.register(makeManifest());
+    expect(registry.getVersion('test-plugin', '9.9.9')).toBeNull();
+  });
+
+  it('should list all plugins', () => {
+    registry.register(makeManifest({ name: 'a', version: '1.0.0' }));
+    registry.register(makeManifest({ name: 'b', version: '1.0.0' }));
+    const all = registry.list();
+    expect(all).toHaveLength(2);
+  });
+
+  it('should list multiple versions of the same plugin', () => {
+    registry.register(makeManifest({ version: '1.0.0' }));
+    registry.register(makeManifest({ version: '2.0.0' }));
+    const all = registry.list();
+    expect(all).toHaveLength(2);
+  });
+
+  it('should search by name', () => {
+    registry.register(makeManifest({ name: 'cool-plugin' }));
+    registry.register(makeManifest({ name: 'boring-lib' }));
+    const results = registry.search('cool');
+    expect(results).toHaveLength(1);
+    expect(results[0].name).toBe('cool-plugin');
+  });
+
+  it('should search by description', () => {
+    registry.register(makeManifest({ name: 'x', description: 'A fantastic logger' }));
+    registry.register(makeManifest({ name: 'y', description: 'A boring thing' }));
+    const results = registry.search('fantastic');
+    expect(results).toHaveLength(1);
+    expect(results[0].name).toBe('x');
+  });
+
+  it('should search by author', () => {
+    registry.register(makeManifest({ name: 'x', author: 'alice' }));
+    registry.register(makeManifest({ name: 'y', author: 'bob' }));
+    const results = registry.search('alice');
+    expect(results).toHaveLength(1);
+  });
+
+  it('should remove a specific version', () => {
+    registry.register(makeManifest({ version: '1.0.0' }));
+    registry.register(makeManifest({ version: '2.0.0' }));
+    const removed = registry.remove('test-plugin', '1.0.0');
+    expect(removed).toBe(true);
+    expect(registry.getVersion('test-plugin', '1.0.0')).toBeNull();
+    expect(registry.getVersion('test-plugin', '2.0.0')).not.toBeNull();
+  });
+
+  it('should return false when removing nonexistent version', () => {
+    expect(registry.remove('unknown', '1.0.0')).toBe(false);
+  });
+
+  it('should list versions for a plugin', () => {
+    registry.register(makeManifest({ version: '1.0.0' }));
+    registry.register(makeManifest({ version: '2.0.0' }));
+    registry.register(makeManifest({ version: '3.0.0' }));
+    const versions = registry.listVersions('test-plugin');
+    expect(versions).toEqual(['1.0.0', '2.0.0', '3.0.0']);
+  });
+
+  it('should return empty array for unknown plugin versions', () => {
+    expect(registry.listVersions('unknown')).toEqual([]);
+  });
+
+  it('should update a plugin', () => {
+    registry.register(makeManifest());
+    registry.update('test-plugin', '1.0.0', { description: 'Updated desc' });
+    const result = registry.getVersion('test-plugin', '1.0.0');
+    expect(result!.description).toBe('Updated desc');
+  });
+
+  it('should throw when updating nonexistent plugin', () => {
+    expect(() => registry.update('unknown', '1.0.0', {})).toThrow();
+  });
+
+  it('should throw when registering without name or version', () => {
+    expect(() =>
+      registry.register(makeManifest({ name: '' }))
+    ).toThrow();
+    expect(() =>
+      registry.register(makeManifest({ version: '' }))
+    ).toThrow();
+  });
+});
diff --git a/src/resolver/index.ts b/src/resolver/index.ts
new file mode 100644
index 0000000..d4cf583
--- /dev/null
+++ b/src/resolver/index.ts
@@ -0,0 +1,44 @@
+import semver from 'semver';
+import type { VersionConstraint, ResolvedVersion, ResolverService } from '../types.js';
+
+export function createResolver(): ResolverService {
+  return {
+    resolve(constraints: VersionConstraint[], available: Record<string, string[]>): ResolvedVersion[] {
+      const resolved: ResolvedVersion[] = [];
+
+      for (const constraint of constraints) {
+        const versions = available[constraint.name];
+        if (!versions || versions.length === 0) {
+          throw new Error(`No versions available for "${constraint.name}"`);
+        }
+
+        const best = semver.maxSatisfying(versions, constraint.range);
+        if (!best) {
+          throw new Error(
+            `No version of "${constraint.name}" satisfies range "${constraint.range}"`
+          );
+        }
+
+        resolved.push({
+          name: constraint.name,
+          version: best,
+          satisfies: constraint.range,
+        });
+      }
+
+      return resolved;
+    },
+
+    satisfies(version: string, range: string): boolean {
+      return semver.satisfies(version, range);
+    },
+
+    maxSatisfying(versions: string[], range: string): string | null {
+      return semver.maxSatisfying(versions, range);
+    },
+
+    validRange(range: string): boolean {
+      return semver.validRange(range) !== null;
+    },
+  };
+}
diff --git a/src/resolver/resolver.test.ts b/src/resolver/resolver.test.ts
new file mode 100644
index 0000000..b1ebba7
--- /dev/null
+++ b/src/resolver/resolver.test.ts
@@ -0,0 +1,86 @@
+import { describe, it, expect } from 'vitest';
+import { createResolver } from './index.js';
+
+describe('Resolver', () => {
+  const resolver = createResolver();
+
+  describe('resolve', () => {
+    it('should resolve single constraint', () => {
+      const result = resolver.resolve(
+        [{ name: 'foo', range: '^1.0.0' }],
+        { foo: ['1.0.0', '1.1.0', '1.2.0', '2.0.0'] }
+      );
+      expect(result).toHaveLength(1);
+      expect(result[0].name).toBe('foo');
+      expect(result[0].version).toBe('1.2.0');
+      expect(result[0].satisfies).toBe('^1.0.0');
+    });
+
+    it('should resolve multiple constraints', () => {
+      const result = resolver.resolve(
+        [
+          { name: 'foo', range: '^1.0.0' },
+          { name: 'bar', range: '~2.1.0' },
+        ],
+        {
+          foo: ['1.0.0', '1.5.0'],
+          bar: ['2.0.0', '2.1.0', '2.1.5', '2.2.0'],
+        }
+      );
+      expect(result).toHaveLength(2);
+      expect(result[0].version).toBe('1.5.0');
+      expect(result[1].version).toBe('2.1.5');
+    });
+
+    it('should throw when no versions available', () => {
+      expect(() =>
+        resolver.resolve([{ name: 'foo', range: '^1.0.0' }], {})
+      ).toThrow('No versions available for "foo"');
+    });
+
+    it('should throw when no version satisfies range', () => {
+      expect(() =>
+        resolver.resolve(
+          [{ name: 'foo', range: '^3.0.0' }],
+          { foo: ['1.0.0', '2.0.0'] }
+        )
+      ).toThrow('No version of "foo" satisfies range "^3.0.0"');
+    });
+  });
+
+  describe('satisfies', () => {
+    it('should return true for valid match', () => {
+      expect(resolver.satisfies('1.2.3', '^1.0.0')).toBe(true);
+    });
+
+    it('should return false for invalid match', () => {
+      expect(resolver.satisfies('2.0.0', '^1.0.0')).toBe(false);
+    });
+  });
+
+  describe('maxSatisfying', () => {
+    it('should return the highest matching version', () => {
+      expect(
+        resolver.maxSatisfying(['1.0.0', '1.1.0', '1.2.0', '2.0.0'], '^1.0.0')
+      ).toBe('1.2.0');
+    });
+
+    it('should return null when nothing matches', () => {
+      expect(
+        resolver.maxSatisfying(['1.0.0'], '^2.0.0')
+      ).toBeNull();
+    });
+  });
+
+  describe('validRange', () => {
+    it('should return true for valid ranges', () => {
+      expect(resolver.validRange('^1.0.0')).toBe(true);
+      expect(resolver.validRange('~1.0.0')).toBe(true);
+      expect(resolver.validRange('>=1.0.0 <2.0.0')).toBe(true);
+    });
+
+    it('should return false for invalid ranges', () => {
+      expect(resolver.validRange('not-a-range')).toBe(false);
+    });
+  });
+});
diff --git a/src/reviews/index.ts b/src/reviews/index.ts
new file mode 100644
index 0000000..dbb8438
--- /dev/null
+++ b/src/reviews/index.ts
@@ -0,0 +1,64 @@
+import type { Review, ReviewService } from '../types.js';
+
+export function createReviewService(): ReviewService {
+  const reviews: Review[] = [];
+  let nextId = 1;
+
+  return {
+    addReview(review: Omit<Review, 'id' | 'createdAt' | 'flagged'>): Review {
+      if (review.rating < 1 || review.rating > 5) {
+        throw new Error('Rating must be between 1 and 5');
+      }
+      const newReview: Review = {
+        ...review,
+        id: nextId++,
+        flagged: false,
+        createdAt: new Date().toISOString(),
+      };
+      reviews.push(newReview);
+      return { ...newReview };
+    },
+
+    getReviews(pluginName: string): Review[] {
+      return reviews
+        .filter((r) => r.pluginName === pluginName)
+        .map((r) => ({ ...r }));
+    },
+
+    getAverageRating(pluginName: string): number {
+      const pluginReviews = reviews.filter(
+        (r) => r.pluginName === pluginName && !r.flagged
+      );
+      if (pluginReviews.length === 0) return 0;
+      const sum = pluginReviews.reduce((acc, r) => acc + r.rating, 0);
+      return sum / pluginReviews.length;
+    },
+
+    flagReview(reviewId: number): void {
+      const review = reviews.find((r) => r.id === reviewId);
+      if (!review) throw new Error(`Review ${reviewId} not found`);
+      review.flagged = true;
+    },
+
+    getFlaggedReviews(): Review[] {
+      return reviews.filter((r) => r.flagged).map((r) => ({ ...r }));
+    },
+
+    removeReview(reviewId: number): boolean {
+      const index = reviews.findIndex((r) => r.id === reviewId);
+      if (index === -1) return false;
+      reviews.splice(index, 1);
+      return true;
+    },
+
+    getReviewsByUser(userId: string): Review[] {
+      return reviews
+        .filter((r) => r.userId === userId)
+        .map((r) => ({ ...r }));
+    },
+
+    getReviewCount(pluginName: string): number {
+      return reviews.filter((r) => r.pluginName === pluginName).length;
+    },
+  };
+}
diff --git a/src/reviews/reviews.test.ts b/src/reviews/reviews.test.ts
new file mode 100644
index 0000000..21dda8d
--- /dev/null
+++ b/src/reviews/reviews.test.ts
@@ -0,0 +1,171 @@
+import { describe, it, expect, beforeEach } from 'vitest';
+import { createReviewService } from './index.js';
+import type { ReviewService } from '../types.js';
+
+describe('ReviewService', () => {
+  let reviews: ReviewService;
+
+  beforeEach(() => {
+    reviews = createReviewService();
+  });
+
+  it('should add a review', () => {
+    const review = reviews.addReview({
+      pluginName: 'test-plugin',
+      pluginVersion: '1.0.0',
+      userId: 'user1',
+      rating: 5,
+      comment: 'Great plugin!',
+    });
+    expect(review.id).toBe(1);
+    expect(review.flagged).toBe(false);
+    expect(review.createdAt).toBeDefined();
+    expect(review.rating).toBe(5);
+  });
+
+  it('should reject invalid ratings', () => {
+    expect(() =>
+      reviews.addReview({
+        pluginName: 'test',
+        pluginVersion: '1.0.0',
+        userId: 'user1',
+        rating: 0,
+        comment: '',
+      })
+    ).toThrow('Rating must be between 1 and 5');
+
+    expect(() =>
+      reviews.addReview({
+        pluginName: 'test',
+        pluginVersion: '1.0.0',
+        userId: 'user1',
+        rating: 6,
+        comment: '',
+      })
+    ).toThrow('Rating must be between 1 and 5');
+  });
+
+  it('should get reviews by plugin', () => {
+    reviews.addReview({
+      pluginName: 'plugin-a',
+      pluginVersion: '1.0.0',
+      userId: 'user1',
+      rating: 4,
+      comment: 'Good',
+    });
+    reviews.addReview({
+      pluginName: 'plugin-b',
+      pluginVersion: '1.0.0',
+      userId: 'user1',
+      rating: 3,
+      comment: 'Ok',
+    });
+    const result = reviews.getReviews('plugin-a');
+    expect(result).toHaveLength(1);
+    expect(result[0].pluginName).toBe('plugin-a');
+  });
+
+  it('should compute average rating excluding flagged', () => {
+    reviews.addReview({
+      pluginName: 'test',
+      pluginVersion: '1.0.0',
+      userId: 'user1',
+      rating: 5,
+      comment: '',
+    });
+    reviews.addReview({
+      pluginName: 'test',
+      pluginVersion: '1.0.0',
+      userId: 'user2',
+      rating: 3,
+      comment: '',
+    });
+    const r3 = reviews.addReview({
+      pluginName: 'test',
+      pluginVersion: '1.0.0',
+      userId: 'user3',
+      rating: 1,
+      comment: 'spam',
+    });
+    reviews.flagReview(r3.id);
+
+    // Average of 5 and 3 = 4 (excluding flagged 1)
+    expect(reviews.getAverageRating('test')).toBe(4);
+  });
+
+  it('should return 0 for no reviews', () => {
+    expect(reviews.getAverageRating('nonexistent')).toBe(0);
+  });
+
+  it('should flag and get flagged reviews', () => {
+    const r1 = reviews.addReview({
+      pluginName: 'test',
+      pluginVersion: '1.0.0',
+      userId: 'user1',
+      rating: 1,
+      comment: 'bad',
+    });
+    reviews.flagReview(r1.id);
+    const flagged = reviews.getFlaggedReviews();
+    expect(flagged).toHaveLength(1);
+    expect(flagged[0].flagged).toBe(true);
+  });
+
+  it('should throw when flagging nonexistent review', () => {
+    expect(() => reviews.flagReview(999)).toThrow();
+  });
+
+  it('should remove a review', () => {
+    const r = reviews.addReview({
+      pluginName: 'test',
+      pluginVersion: '1.0.0',
+      userId: 'user1',
+      rating: 3,
+      comment: '',
+    });
+    expect(reviews.removeReview(r.id)).toBe(true);
+    expect(reviews.getReviews('test')).toHaveLength(0);
+  });
+
+  it('should return false for removing nonexistent review', () => {
+    expect(reviews.removeReview(999)).toBe(false);
+  });
+
+  it('should get reviews by user', () => {
+    reviews.addReview({
+      pluginName: 'test-a',
+      pluginVersion: '1.0.0',
+      userId: 'alice',
+      rating: 5,
+      comment: '',
+    });
+    reviews.addReview({
+      pluginName: 'test-b',
+      pluginVersion: '1.0.0',
+      userId: 'bob',
+      rating: 3,
+      comment: '',
+    });
+    const result = reviews.getReviewsByUser('alice');
+    expect(result).toHaveLength(1);
+    expect(result[0].userId).toBe('alice');
+  });
+
+  it('should get review count', () => {
+    reviews.addReview({
+      pluginName: 'test',
+      pluginVersion: '1.0.0',
+      userId: 'user1',
+      rating: 5,
+      comment: '',
+    });
+    reviews.addReview({
+      pluginName: 'test',
+      pluginVersion: '1.0.0',
+      userId: 'user2',
+      rating: 3,
+      comment: '',
+    });
+    expect(reviews.getReviewCount('test')).toBe(2);
+  });
+});
diff --git a/src/runner/index.ts b/src/runner/index.ts
new file mode 100644
index 0000000..ee2e9d2
--- /dev/null
+++ b/src/runner/index.ts
@@ -0,0 +1,78 @@
+import vm from 'node:vm';
+import type { SandboxResult, RunnerService } from '../types.js';
+
+const DEFAULT_TIMEOUT = 5000;
+
+export function createRunner(): RunnerService {
+  function executeCode(
+    code: string,
+    timeoutMs: number,
+    context: Record<string, unknown> = {}
+  ): Promise<SandboxResult> {
+    return new Promise((resolve) => {
+      const startTime = performance.now();
+      const startMem = process.memoryUsage().heapUsed;
+
+      try {
+        const sandbox: Record<string, unknown> = {
+          ...context,
+          console: {
+            log: (...args: unknown[]) => {
+              outputs.push(args.map(String).join(' '));
+            },
+            error: (...args: unknown[]) => {
+              outputs.push(args.map(String).join(' '));
+            },
+            warn: (...args: unknown[]) => {
+              outputs.push(args.map(String).join(' '));
+            },
+          },
+        };
+        const outputs: string[] = [];
+
+        const vmContext = vm.createContext(sandbox);
+        const script = new vm.Script(code, { filename: 'plugin.js' });
+        const result = script.runInContext(vmContext, { timeout: timeoutMs });
+
+        const duration = performance.now() - startTime;
+        const memoryUsed = Math.max(0, process.memoryUsage().heapUsed - startMem);
+
+        resolve({
+          success: true,
+          output: result !== undefined ? result : (outputs.length > 0 ? outputs.join('\n') : null),
+          duration,
+          memoryUsed,
+        });
+      } catch (err: unknown) {
+        const duration = performance.now() - startTime;
+        const memoryUsed = Math.max(0, process.memoryUsage().heapUsed - startMem);
+        const errObj = err as Record<string, unknown>;
+        const message = (typeof errObj === 'object' && errObj !== null && 'message' in errObj)
+          ? String(errObj.message)
+          : String(err);
+
+        resolve({
+          success: false,
+          output: null,
+          duration,
+          memoryUsed,
+          error: message,
+        });
+      }
+    });
+  }
+
+  return {
+    execute(code: string, context?: Record<string, unknown>): Promise<SandboxResult> {
+      return executeCode(code, DEFAULT_TIMEOUT, context);
+    },
+
+    executeWithTimeout(
+      code: string,
+      timeoutMs: number,
+      context?: Record<string, unknown>
+    ): Promise<SandboxResult> {
+      return executeCode(code, timeoutMs, context);
+    },
+  };
+}
diff --git a/src/runner/runner.test.ts b/src/runner/runner.test.ts
new file mode 100644
index 0000000..97648a4
--- /dev/null
+++ b/src/runner/runner.test.ts
@@ -0,0 +1,48 @@
+import { describe, it, expect } from 'vitest';
+import { createRunner } from './index.js';
+
+describe('Runner', () => {
+  const runner = createRunner();
+
+  describe('execute', () => {
+    it('should execute simple code and return result', async () => {
+      const result = await runner.execute('1 + 1');
+      expect(result.success).toBe(true);
+      expect(result.output).toBe(2);
+      expect(result.duration).toBeGreaterThanOrEqual(0);
+      expect(result.memoryUsed).toBeGreaterThanOrEqual(0);
+    });
+
+    it('should capture errors', async () => {
+      const result = await runner.execute('throw new Error("boom")');
+      expect(result.success).toBe(false);
+      expect(result.error).toBe('boom');
+    });
+
+    it('should accept context variables', async () => {
+      const result = await runner.execute('x + y', { x: 10, y: 20 });
+      expect(result.success).toBe(true);
+      expect(result.output).toBe(30);
+    });
+
+    it('should handle syntax errors', async () => {
+      const result = await runner.execute('if (true {');
+      expect(result.success).toBe(false);
+      expect(result.error).toBeDefined();
+    });
+  });
+
+  describe('executeWithTimeout', () => {
+    it('should timeout on infinite loops', async () => {
+      const result = await runner.executeWithTimeout('while(true){}', 50);
+      expect(result.success).toBe(false);
+      expect(result.error).toBeDefined();
+    });
+
+    it('should succeed within timeout', async () => {
+      const result = await runner.executeWithTimeout('42', 1000);
+      expect(result.success).toBe(true);
+      expect(result.output).toBe(42);
+    });
+  });
+});
